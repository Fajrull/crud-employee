<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Management System</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px 0;
        }

        .main-card {
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }

        .card-header {
            border-radius: 20px 20px 0 0 !important;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            border: none;
            padding: 20px;
        }

        .btn-custom {
            border-radius: 25px;
            padding: 10px 25px;
            transition: all 0.3s ease;
        }

        .btn-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .table {
            border-radius: 15px;
            overflow: hidden;
        }

        .table thead th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-weight: 600;
        }

        .modal-content {
            border-radius: 20px;
            border: none;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px 20px 0 0;
            border: none;
        }

        .form-control, .form-select {
            border-radius: 15px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }

        .status-card {
            border-radius: 15px;
            border: none;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .table-responsive {
                border-radius: 15px;
            }

            .btn-group-mobile {
                display: flex;
                flex-direction: column;
                gap: 5px;
            }

            .btn-group-mobile .btn {
                width: 100%;
            }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-spinner {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="container-fluid px-3">
    <div class="row justify-content-center">
        <div class="col-12 col-xl-10">
            <div class="card main-card">
                <div class="card-header d-flex justify-content-between align-items-center flex-wrap">
                    <h4 class="mb-0 text-white">
                        <i class="fas fa-users me-2"></i>Employee Management System
                    </h4>
                    <div class="d-flex gap-2 mt-2 mt-md-0">
                        <button class="btn btn-light btn-custom" data-bs-toggle="modal" data-bs-target="#addEmployeeModal">
                            <i class="fas fa-plus me-1"></i> Add Employee
                        </button>
                        <button type="button" class="btn btn-outline-light btn-custom" onclick="refreshData()">
                            <i class="fas fa-refresh me-1"></i> Refresh
                        </button>
                    </div>
                </div>
                <div class="card-body p-4">

                    <div id="status" class="alert status-card" style="display: none;">
                        <i class="fas fa-info-circle me-2"></i><span id="statusMessage"></span>
                    </div>

                    <!-- Search and Filter Section -->
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-search"></i></span>
                                <input type="text" class="form-control" id="searchInput" placeholder="Search employees...">
                                <button class="btn btn-outline-secondary" type="button" onclick="searchEmployees()">Search</button>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <select class="form-select" id="pageSizeSelect" onchange="changePageSize()">
                                <option value="5">5 per page</option>
                                <option value="10" selected>10 per page</option>
                                <option value="20">20 per page</option>
                                <option value="50">50 per page</option>
                            </select>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead>
                            <tr>
                                <th>No</th>
                                <th>Employee ID</th>
                                <th>Full Name</th>
                                <th>Gender</th>
                                <th class="text-center">Actions</th>
                            </tr>
                            </thead>
                            <tbody id="employeeTableBody">
                            <tr>
                                <td colspan="5" class="text-center py-5">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    <p class="mt-2 text-muted">Loading employees...</p>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination Section -->
                    <div class="row mt-4">
                        <div class="col-md-6 d-flex align-items-center">
                            <span id="paginationInfo" class="text-muted">Showing 0 to 0 of 0 entries</span>
                        </div>
                        <div class="col-md-6">
                            <nav aria-label="Employee pagination">
                                <ul class="pagination justify-content-end mb-0" id="paginationContainer">
                                    <!-- Pagination will be generated here -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="loading-spinner">
        <div class="spinner-border text-primary mb-3" role="status"></div>
        <p class="mb-0">Processing...</p>
    </div>
</div>

<!-- ==================== MODALS ==================== -->

<!-- Success Modal -->
<div class="modal fade" id="successModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body text-center p-4">
                <i class="fas fa-check-circle text-success" style="font-size: 3rem;"></i>
                <h4 class="mt-3 mb-3">Success!</h4>
                <p id="successMessage" class="text-muted"></p>
                <button type="button" class="btn btn-success btn-custom" data-bs-dismiss="modal">OK</button>
            </div>
        </div>
    </div>
</div>

<!-- Add Employee Modal -->
<div class="modal fade" id="addEmployeeModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <form id="addEmployeeForm" class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-user-plus me-2"></i>Add New Employee</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <div class="mb-3">
                    <label class="form-label fw-bold">First Name</label>
                    <input type="text" class="form-control" name="firstName" required>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold">Last Name</label>
                    <input type="text" class="form-control" name="lastName" required>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold">Gender</label>
                    <select class="form-select" name="gender" required>
                        <option value="">-- Select Gender --</option>
                        <option value="M">Male</option>
                        <option value="F">Female</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold">Birth Date</label>
                    <input type="date" class="form-control" name="birthDate" required>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold">Hire Date</label>
                    <input type="date" class="form-control" name="hireDate" required>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btn-custom" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-success btn-custom">
                    <i class="fas fa-save me-1"></i>Save Employee
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Edit Employee Modal -->
<div class="modal fade" id="editEmployeeModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <form id="editEmployeeForm" class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-edit me-2"></i>Edit Employee</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <input type="hidden" id="editEmployeeId">
                <div class="mb-3">
                    <label class="form-label fw-bold">First Name</label>
                    <input type="text" class="form-control" id="editFirstName" required>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold">Last Name</label>
                    <input type="text" class="form-control" id="editLastName" required>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold">Gender</label>
                    <select class="form-select" id="editGender" required>
                        <option value="M">Male</option>
                        <option value="F">Female</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold">Birth Date</label>
                    <input type="date" class="form-control" id="editBirthDate" required>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold">Hire Date</label>
                    <input type="date" class="form-control" id="editHireDate" required>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btn-custom" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-success btn-custom">
                    <i class="fas fa-save me-1"></i>Update Employee
                </button>
            </div>
        </form>
    </div>
</div>

<!-- View Employee Modal -->
<div class="modal fade" id="viewEmployeeModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-eye me-2"></i>Employee Details</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <div class="row">
                    <div class="col-12">
                        <div class="card bg-light">
                            <div class="card-body">
                                <p class="mb-2"><strong><i class="fas fa-id-badge me-2"></i>ID:</strong> <span id="viewId" class="text-muted"></span></p>
                                <p class="mb-2"><strong><i class="fas fa-user me-2"></i>Name:</strong> <span id="viewName"></span></p>
                                <p class="mb-2"><strong><i class="fas fa-venus-mars me-2"></i>Gender:</strong> <span id="viewGender"></span></p>
                                <p class="mb-2"><strong><i class="fas fa-birthday-cake me-2"></i>Birth Date:</strong> <span id="viewBirthDate"></span></p>
                                <p class="mb-0"><strong><i class="fas fa-calendar me-2"></i>Hire Date:</strong> <span id="viewHireDate"></span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btn-custom" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteEmployeeModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-trash me-2"></i>Confirm Deletion</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-4">
                <p class="mb-0">Are you sure you want to delete this employee? This action cannot be undone.</p>
                <input type="hidden" id="deleteEmployeeId">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btn-custom" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger btn-custom" onclick="deleteEmployee()">
                    <i class="fas fa-trash me-1"></i>Delete
                </button>
            </div>
        </div>
    </div>
</div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Global pagination variables
    let currentPage = 1;
    let currentPageSize = 10;
    let currentSearch = '';
    let totalPages = 0;
    let totalElements = 0;

    $(document).ready(function() {
        // Load data immediately when page loads
        loadEmployees();

        // Search on Enter key press
        $("#searchInput").keypress(function(event) {
            if (event.which === 13) {
                searchEmployees();
            }
        });

        // ADD EMPLOYEE
        $("#addEmployeeForm").submit(function(e) {
            e.preventDefault();
            showLoading();

            const data = {
                firstName: $(this).find("[name=firstName]").val(),
                lastName: $(this).find("[name=lastName]").val(),
                gender: $(this).find("[name=gender]").val(),
                birthDate: $(this).find("[name=birthDate]").val(),
                hireDate: $(this).find("[name=hireDate]").val()
            };

            $.ajax({
                url: "/api/v1/employee",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function(response) {
                    hideLoading();
                    $("#addEmployeeModal").modal("hide");
                    showSuccessModal("Employee added successfully!");
                    // Reset form
                    $("#addEmployeeForm")[0].reset();
                    // Reload data
                    loadEmployees();
                },
                error: function(xhr) {
                    hideLoading();
                    updateStatus("Failed to add employee: " + (xhr.responseJSON?.message || xhr.responseText), "danger");
                }
            });
        });

        // EDIT EMPLOYEE
        $("#editEmployeeForm").submit(function(e) {
            e.preventDefault();
            showLoading();

            const id = $("#editEmployeeId").val();
            const data = {
                firstName: $("#editFirstName").val(),
                lastName: $("#editLastName").val(),
                gender: $("#editGender").val(),
                birthDate: $("#editBirthDate").val(),
                hireDate: $("#editHireDate").val()
            };

            // Try PATCH method first, if fails try PUT
            $.ajax({
                url: `/api/v1/employee/${id}`,
                type: "PATCH",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function(response) {
                    hideLoading();
                    $("#editEmployeeModal").modal("hide");
                    showSuccessModal("Employee updated successfully!");
                    loadEmployees();
                },
                error: function(xhr) {
                    // If PATCH fails, try PUT
                    if (xhr.status === 405) {
                        $.ajax({
                            url: `/api/v1/employee/${id}`,
                            type: "PUT",
                            contentType: "application/json",
                            data: JSON.stringify(data),
                            success: function(response) {
                                hideLoading();
                                $("#editEmployeeModal").modal("hide");
                                showSuccessModal("Employee updated successfully!");
                                loadEmployees();
                            },
                            error: function(xhr2) {
                                hideLoading();
                                updateStatus("Failed to update employee: " + (xhr2.responseJSON?.message || xhr2.responseText), "danger");
                            }
                        });
                    } else {
                        hideLoading();
                        updateStatus("Failed to update employee: " + (xhr.responseJSON?.message || xhr.responseText), "danger");
                    }
                }
            });
        });
    });

    function showLoading() {
        $("#loadingOverlay").show();
    }

    function hideLoading() {
        $("#loadingOverlay").hide();
    }

    function showSuccessModal(message) {
        $("#successMessage").text(message);
        $("#successModal").modal("show");
    }

    function updateStatus(message, type = "info") {
        const statusDiv = $('#status');
        const statusMessage = $('#statusMessage');

        statusDiv.removeClass('alert-info alert-success alert-danger alert-warning');
        statusDiv.addClass(`alert-${type}`);
        statusDiv.show();

        const icon = type === "success" ? "check-circle" :
                    type === "danger" ? "exclamation-triangle" : "info-circle";

        statusMessage.html(`<i class="fas fa-${icon} me-2"></i>${message}`);

        // Auto hide after 5 seconds
        setTimeout(function() {
            statusDiv.fadeOut();
        }, 5000);
    }

    function loadEmployees(page = currentPage) {
        currentPage = page;

        const params = {
            page: currentPage,
            size: currentPageSize,
        };

        if (currentSearch.trim() !== '') {
            params.search = currentSearch.trim();
        }

        $.ajax({
            url: "/api/v1/employee",
            type: "GET",
            data: params,
            success: function(response) {
                if (response.statusCode === 200) {
                    totalPages = response.paging.totalPages;
                    totalElements = response.paging.totalElements;

                    const startEntry = ((currentPage - 1) * currentPageSize) + 1;
                    const endEntry = Math.min(currentPage * currentPageSize, totalElements);

                    updateStatus(`Showing ${startEntry} to ${endEntry} of ${totalElements} employees`, "success");
                    displayEmployees(response.data, startEntry);
                    updatePagination(response.paging);
                } else {
                    displayEmployees(response.data || [], 1);
                    updatePagination({totalPages: 0, totalElements: 0, page: 1, hasNext: false, hasPrevious: false});
                }
            },
            error: function(xhr) {
                updateStatus("Failed to load employees: " + (xhr.responseJSON?.message || xhr.responseText), "danger");
                displayError(xhr);
                updatePagination({totalPages: 0, totalElements: 0, page: 1, hasNext: false, hasPrevious: false});
            }
        });
    }

    function refreshData() {
        updateStatus("Refreshing data...", "info");
        loadEmployees(currentPage);
    }

    function searchEmployees() {
        currentSearch = $("#searchInput").val();
        currentPage = 1; // Reset to first page when searching
        loadEmployees(1);
    }

    function changePageSize() {
        currentPageSize = parseInt($("#pageSizeSelect").val());
        currentPage = 1; // Reset to first page when changing page size
        loadEmployees(1);
    }

    function goToPage(page) {
        if (page >= 1 && page <= totalPages) {
            loadEmployees(page);
        }
    }

    function updatePagination(paging) {
        const paginationContainer = $('#paginationContainer');
        const paginationInfo = $('#paginationInfo');

        // Update info text
        if (paging.totalElements === 0) {
            paginationInfo.text('No entries found');
        } else {
            const startEntry = ((currentPage - 1) * currentPageSize) + 1;
            const endEntry = Math.min(currentPage * currentPageSize, paging.totalElements);
            paginationInfo.text(`Showing ${startEntry} to ${endEntry} of ${paging.totalElements} entries`);
        }

        // Clear existing pagination
        paginationContainer.empty();

        if (paging.totalPages <= 1) {
            return; // Don't show pagination if only one page or no data
        }

        // Previous button
        const prevDisabled = !paging.hasPrevious ? 'disabled' : '';
        paginationContainer.append(`
            <li class="page-item ${prevDisabled}">
                <a class="page-link" href="#" onclick="goToPage(${currentPage - 1})" ${prevDisabled ? 'tabindex="-1"' : ''}>
                    <i class="fas fa-chevron-left"></i> Previous
                </a>
            </li>
        `);

        // Calculate page range to show
        let startPage = Math.max(1, currentPage - 2);
        let endPage = Math.min(paging.totalPages, currentPage + 2);

        // Adjust if we're near the beginning
        if (currentPage <= 3) {
            endPage = Math.min(5, paging.totalPages);
        }

        // Adjust if we're near the end
        if (currentPage > paging.totalPages - 3) {
            startPage = Math.max(1, paging.totalPages - 4);
        }

        // First page if not in range
        if (startPage > 1) {
            paginationContainer.append(`
                <li class="page-item">
                    <a class="page-link" href="#" onclick="goToPage(1)">1</a>
                </li>
            `);
            if (startPage > 2) {
                paginationContainer.append(`<li class="page-item disabled"><span class="page-link">...</span></li>`);
            }
        }

        // Page numbers
        for (let i = startPage; i <= endPage; i++) {
            const activeClass = i === currentPage ? 'active' : '';
            paginationContainer.append(`
                <li class="page-item ${activeClass}">
                    <a class="page-link" href="#" onclick="goToPage(${i})">${i}</a>
                </li>
            `);
        }

        // Last page if not in range
        if (endPage < paging.totalPages) {
            if (endPage < paging.totalPages - 1) {
                paginationContainer.append(`<li class="page-item disabled"><span class="page-link">...</span></li>`);
            }
            paginationContainer.append(`
                <li class="page-item">
                    <a class="page-link" href="#" onclick="goToPage(${paging.totalPages})">${paging.totalPages}</a>
                </li>
            `);
        }

        // Next button
        const nextDisabled = !paging.hasNext ? 'disabled' : '';
        paginationContainer.append(`
            <li class="page-item ${nextDisabled}">
                <a class="page-link" href="#" onclick="goToPage(${currentPage + 1})" ${nextDisabled ? 'tabindex="-1"' : ''}>
                    Next <i class="fas fa-chevron-right"></i>
                </a>
            </li>
        `);
    }

    function displayEmployees(employees, startNumber = 1) {
        const tbody = $('#employeeTableBody');
        tbody.empty();

        if (!employees || employees.length === 0) {
            tbody.html(`
                <tr>
                    <td colspan="5" class="text-center py-5">
                        <i class="fas fa-users text-muted" style="font-size: 3rem;"></i>
                        <p class="text-muted mt-3 mb-0">No employees found</p>
                        <p class="text-muted small">Click "Add Employee" to get started</p>
                    </td>
                </tr>
            `);
            return;
        }

        employees.forEach(function(emp, index) {
            const genderText = emp.gender === 'M' ? 'Male' : 'Female';
            const genderIcon = emp.gender === 'M' ? 'fa-mars text-primary' : 'fa-venus text-danger';

            const row = `
                <tr>
                    <td><span class="badge bg-secondary">${startNumber + index}</span></td>
                    <td><code class="bg-light px-2 py-1 rounded">${emp.id}</code></td>
                    <td>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-user-circle text-muted me-2"></i>
                            <span class="fw-medium">${emp.firstName} ${emp.lastName}</span>
                        </div>
                    </td>
                    <td>
                        <i class="fas ${genderIcon} me-1"></i>
                        ${genderText}
                    </td>
                    <td class="text-center">
                        <div class="btn-group-mobile">
                            <button class="btn btn-sm btn-outline-info me-1" onclick="viewEmployee('${emp.id}')" title="View Details">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-success me-1" onclick="editEmployee('${emp.id}')" title="Edit Employee">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger" onclick="confirmDeleteEmployee('${emp.id}')" title="Delete Employee">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
            tbody.append(row);
        });
    }

    function displayError(xhr) {
        $('#employeeTableBody').html(`
            <tr>
                <td colspan="5" class="text-center py-5 text-danger">
                    <i class="fas fa-exclamation-triangle" style="font-size: 3rem;"></i>
                    <p class="mt-3 mb-0">Error ${xhr.status}</p>
                    <p class="small text-muted">${xhr.responseJSON?.message || xhr.responseText}</p>
                </td>
            </tr>
        `);
    }

    function viewEmployee(id) {
        showLoading();
        $.get(`/api/v1/employee/${id}`)
            .done(function(response) {
                hideLoading();
                if (response.statusCode === 200) {
                    const emp = response.data;
                    $("#viewId").text(emp.id);
                    $("#viewName").text(emp.firstName + " " + emp.lastName);
                    $("#viewGender").text(emp.gender === 'M' ? 'Male' : 'Female');
                    $("#viewBirthDate").text(new Date(emp.birthDate).toLocaleDateString());
                    $("#viewHireDate").text(new Date(emp.hireDate).toLocaleDateString());
                    $("#viewEmployeeModal").modal("show");
                }
            })
            .fail(function(xhr) {
                hideLoading();
                updateStatus("Failed to load employee details: " + (xhr.responseJSON?.message || xhr.responseText), "danger");
            });
    }

    function editEmployee(id) {
        showLoading();
        $.get(`/api/v1/employee/${id}`)
            .done(function(response) {
                hideLoading();
                if (response.statusCode === 200) {
                    const emp = response.data;
                    $("#editEmployeeId").val(emp.id);
                    $("#editFirstName").val(emp.firstName);
                    $("#editLastName").val(emp.lastName);
                    $("#editGender").val(emp.gender);
                    $("#editBirthDate").val(emp.birthDate);
                    $("#editHireDate").val(emp.hireDate);
                    $("#editEmployeeModal").modal("show");
                }
            })
            .fail(function(xhr) {
                hideLoading();
                updateStatus("Failed to load employee for edit: " + (xhr.responseJSON?.message || xhr.responseText), "danger");
            });
    }

    function confirmDeleteEmployee(id) {
        $("#deleteEmployeeId").val(id);
        $("#deleteEmployeeModal").modal("show");
    }

    function deleteEmployee() {
        const id = $("#deleteEmployeeId").val();
        showLoading();

        $.ajax({
            url: `/api/v1/employee/${id}`,
            type: "DELETE",
            success: function(response) {
                hideLoading();
                $("#deleteEmployeeModal").modal("hide");
                showSuccessModal("Employee deleted successfully!");
                loadEmployees(currentPage);
            },
            error: function(xhr) {
                hideLoading();
                $("#deleteEmployeeModal").modal("hide");
                updateStatus("Failed to delete employee: " + (xhr.responseJSON?.message || xhr.responseText), "danger");
            }
        });
    }
</script>
</body>
</html>